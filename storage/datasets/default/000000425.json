{
	"title": "HTMLHeaderTextSplitter | ü¶úÔ∏èüîó Langchain",
	"url": "https://python.langchain.com/docs/modules/data_connection/document_transformers/text_splitters/HTML_header_metadata",
	"html": "ModulesRetrievalDocument transformersText splittersHTMLHeaderTextSplitter\nHTMLHeaderTextSplitter\nDescription and motivation‚Äã\n\nSimilar in concept to the MarkdownHeaderTextSplitter, the HTMLHeaderTextSplitter is a \"structure-aware\" chunker that splits text at the element level and adds metadata for each header \"relevant\" to any given chunk. It can return chunks element by element or combine elements with the same metadata, with the objectives of (a) keeping related text grouped (more or less) semantically and (b) preserving context-rich information encoded in document structures. It can be used with other text splitters as part of a chunking pipeline.\n\nUsage examples‚Äã\n1) With an HTML string:‚Äã\nfrom langchain.text_splitter import HTMLHeaderTextSplitter\n\nhtml_string = \"\"\"\n<!DOCTYPE html>\n<html>\n<body>\n    <div>\n        <h1>Foo</h1>\n        <p>Some intro text about Foo.</p>\n        <div>\n            <h2>Bar main section</h2>\n            <p>Some intro text about Bar.</p>\n            <h3>Bar subsection 1</h3>\n            <p>Some text about the first subtopic of Bar.</p>\n            <h3>Bar subsection 2</h3>\n            <p>Some text about the second subtopic of Bar.</p>\n        </div>\n        <div>\n            <h2>Baz</h2>\n            <p>Some text about Baz</p>\n        </div>\n        <br>\n        <p>Some concluding text about Foo</p>\n    </div>\n</body>\n</html>\n\"\"\"\n\nheaders_to_split_on = [\n    (\"h1\", \"Header 1\"),\n    (\"h2\", \"Header 2\"),\n    (\"h3\", \"Header 3\"),\n]\n\nhtml_splitter = HTMLHeaderTextSplitter(headers_to_split_on=headers_to_split_on)\nhtml_header_splits = html_splitter.split_text(html_string)\nhtml_header_splits\n\n    [Document(page_content='Foo'),\n     Document(page_content='Some intro text about Foo.  \\nBar main section Bar subsection 1 Bar subsection 2', metadata={'Header 1': 'Foo'}),\n     Document(page_content='Some intro text about Bar.', metadata={'Header 1': 'Foo', 'Header 2': 'Bar main section'}),\n     Document(page_content='Some text about the first subtopic of Bar.', metadata={'Header 1': 'Foo', 'Header 2': 'Bar main section', 'Header 3': 'Bar subsection 1'}),\n     Document(page_content='Some text about the second subtopic of Bar.', metadata={'Header 1': 'Foo', 'Header 2': 'Bar main section', 'Header 3': 'Bar subsection 2'}),\n     Document(page_content='Baz', metadata={'Header 1': 'Foo'}),\n     Document(page_content='Some text about Baz', metadata={'Header 1': 'Foo', 'Header 2': 'Baz'}),\n     Document(page_content='Some concluding text about Foo', metadata={'Header 1': 'Foo'})]\n\n2) Pipelined to another splitter, with html loaded from a web URL:‚Äã\nfrom langchain.text_splitter import RecursiveCharacterTextSplitter\n\nurl = \"https://plato.stanford.edu/entries/goedel/\"\n\nheaders_to_split_on = [\n    (\"h1\", \"Header 1\"),\n    (\"h2\", \"Header 2\"),\n    (\"h3\", \"Header 3\"),\n    (\"h4\", \"Header 4\"),\n]\n\nhtml_splitter = HTMLHeaderTextSplitter(headers_to_split_on=headers_to_split_on)\n\n# for local file use html_splitter.split_text_from_file(<path_to_file>)\nhtml_header_splits = html_splitter.split_text_from_url(url)\n\nchunk_size = 500\nchunk_overlap = 30\ntext_splitter = RecursiveCharacterTextSplitter(\n    chunk_size=chunk_size, chunk_overlap=chunk_overlap\n)\n\n# Split\nsplits = text_splitter.split_documents(html_header_splits)\nsplits[80:85]\n\n    [Document(page_content='We see that G√∂del first tried to reduce the consistency problem for analysis to that of arithmetic. This seemed to require a truth definition for arithmetic, which in turn led to paradoxes, such as the Liar paradox (‚ÄúThis sentence is false‚Äù) and Berry‚Äôs paradox (‚ÄúThe least number not defined by an expression consisting of just fourteen English words‚Äù). G√∂del then noticed that such paradoxes would not necessarily arise if truth were replaced by provability. But this means that arithmetic truth', metadata={'Header 1': 'Kurt G√∂del', 'Header 2': '2. G√∂del‚Äôs Mathematical Work', 'Header 3': '2.2 The Incompleteness Theorems', 'Header 4': '2.2.1 The First Incompleteness Theorem'}),\n     Document(page_content='means that arithmetic truth and arithmetic provability are not co-extensive ‚Äî whence the First Incompleteness Theorem.', metadata={'Header 1': 'Kurt G√∂del', 'Header 2': '2. G√∂del‚Äôs Mathematical Work', 'Header 3': '2.2 The Incompleteness Theorems', 'Header 4': '2.2.1 The First Incompleteness Theorem'}),\n     Document(page_content='This account of G√∂del‚Äôs discovery was told to Hao Wang very much after the fact; but in G√∂del‚Äôs contemporary correspondence with Bernays and Zermelo, essentially the same description of his path to the theorems is given. (See G√∂del 2003a and G√∂del 2003b respectively.) From those accounts we see that the undefinability of truth in arithmetic, a result credited to Tarski, was likely obtained in some form by G√∂del by 1931. But he neither publicized nor published the result; the biases logicians', metadata={'Header 1': 'Kurt G√∂del', 'Header 2': '2. G√∂del‚Äôs Mathematical Work', 'Header 3': '2.2 The Incompleteness Theorems', 'Header 4': '2.2.1 The First Incompleteness Theorem'}),\n     Document(page_content='result; the biases logicians had expressed at the time concerning the notion of truth, biases which came vehemently to the fore when Tarski announced his results on the undefinability of truth in formal systems 1935, may have served as a deterrent to G√∂del‚Äôs publication of that theorem.', metadata={'Header 1': 'Kurt G√∂del', 'Header 2': '2. G√∂del‚Äôs Mathematical Work', 'Header 3': '2.2 The Incompleteness Theorems', 'Header 4': '2.2.1 The First Incompleteness Theorem'}),\n     Document(page_content='We now describe the proof of the two theorems, formulating G√∂del‚Äôs results in Peano arithmetic. G√∂del himself used a system related to that defined in Principia Mathematica, but containing Peano arithmetic. In our presentation of the First and Second Incompleteness Theorems we refer to Peano arithmetic as P, following G√∂del‚Äôs notation.', metadata={'Header 1': 'Kurt G√∂del', 'Header 2': '2. G√∂del‚Äôs Mathematical Work', 'Header 3': '2.2 The Incompleteness Theorems', 'Header 4': '2.2.2 The proof of the First Incompleteness Theorem'})]\n\nLimitations‚Äã\n\nThere can be quite a bit of structural variation from one HTML document to another, and while HTMLHeaderTextSplitter will attempt to attach all \"relevant\" headers to any given chunk, it can sometimes miss certain headers. For example, the algorithm assumes an informational hierarchy in which headers are always at nodes \"above\" associated text, i.e. prior siblings, ancestors, and combinations thereof. In the following news article (as of the writing of this document), the document is structured such that the text of the top-level headline, while tagged \"h1\", is in a distinct subtree from the text elements that we'd expect it to be \"above\"‚Äîso we can observe that the \"h1\" element and its associated text do not show up in the chunk metadata (but, where applicable, we do see \"h2\" and its associated text):\n\nurl = \"https://www.cnn.com/2023/09/25/weather/el-nino-winter-us-climate/index.html\"\n\nheaders_to_split_on = [\n    (\"h1\", \"Header 1\"),\n    (\"h2\", \"Header 2\"),\n]\n\nhtml_splitter = HTMLHeaderTextSplitter(headers_to_split_on=headers_to_split_on)\nhtml_header_splits = html_splitter.split_text_from_url(url)\nprint(html_header_splits[1].page_content[:500])\n\n    No two El Ni√É¬±o winters are the same, but many have temperature and precipitation trends in common.  \n    Average conditions during an El Ni√É¬±o winter across the continental US.  \n    One of the major reasons is the position of the jet stream, which often shifts south during an El Ni√É¬±o winter. This shift typically brings wetter and cooler weather to the South while the North becomes drier and warmer, according to NOAA.  \n    Because the jet stream is essentially a river of air that storms flow through, the\n\nPrevious\nDocument transformers\nNext\nSplit by character"
}