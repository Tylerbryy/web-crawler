{
	"title": "OpenAI assistants | ü¶úÔ∏èüîó Langchain",
	"url": "https://python.langchain.com/docs/modules/agents/agent_types/openai_assistants",
	"html": "ModulesAgentsAgent TypesOpenAI assistants\nOpenAI assistants\n\nThe Assistants API allows you to build AI assistants within your own applications. An Assistant has instructions and can leverage models, tools, and knowledge to respond to user queries. The Assistants API currently supports three types of tools: Code Interpreter, Retrieval, and Function calling\n\nYou can interact with OpenAI Assistants using OpenAI tools or custom tools. When using exclusively OpenAI tools, you can just invoke the assistant directly and get final answers. When using custom tools, you can run the assistant and tool execution loop using the built-in AgentExecutor or easily write your own executor.\n\nBelow we show the different ways to interact with Assistants. As a simple example, let's build a math tutor that can write and run code.\n\nUsing only OpenAI tools‚Äã\nfrom langchain.agents.openai_assistant import OpenAIAssistantRunnable\n\ninterpreter_assistant = OpenAIAssistantRunnable.create_assistant(\n    name=\"langchain assistant\",\n    instructions=\"You are a personal math tutor. Write and run code to answer math questions.\",\n    tools=[{\"type\": \"code_interpreter\"}],\n    model=\"gpt-4-1106-preview\",\n)\noutput = interpreter_assistant.invoke({\"content\": \"What's 10 - 4 raised to the 2.7\"})\noutput\n\n    [ThreadMessage(id='msg_qgxkD5kvkZyl0qOaL4czPFkZ', assistant_id='asst_0T8S7CJuUa4Y4hm1PF6n62v7', content=[MessageContentText(text=Text(annotations=[], value='The result of the calculation \\\\(10 - 4^{2.7}\\\\) is approximately \\\\(-32.224\\\\).'), type='text')], created_at=1700169519, file_ids=[], metadata={}, object='thread.message', role='assistant', run_id='run_aH3ZgSWNk3vYIBQm3vpE8tr4', thread_id='thread_9K6cYfx1RBh0pOWD8SxwVWW9')]\n\nAs a LangChain agent with arbitrary tools‚Äã\n\nNow let's recreate this functionality using our own tools. For this example we'll use the E2B sandbox runtime tool.\n\npip install e2b duckduckgo-search\n\nimport getpass\n\nfrom langchain.tools import DuckDuckGoSearchRun, E2BDataAnalysisTool\n\ntools = [E2BDataAnalysisTool(api_key=getpass.getpass()), DuckDuckGoSearchRun()]\n\nagent = OpenAIAssistantRunnable.create_assistant(\n    name=\"langchain assistant e2b tool\",\n    instructions=\"You are a personal math tutor. Write and run code to answer math questions. You can also search the internet.\",\n    tools=tools,\n    model=\"gpt-4-1106-preview\",\n    as_agent=True,\n)\n\nUsing AgentExecutor‚Äã\n\nThe OpenAIAssistantRunnable is compatible with the AgentExecutor, so we can pass it in as an agent directly to the executor. The AgentExecutor handles calling the invoked tools and uploading the tool outputs back to the Assistants API. Plus it comes with built-in LangSmith tracing.\n\nfrom langchain.agents import AgentExecutor\n\nagent_executor = AgentExecutor(agent=agent, tools=tools)\nagent_executor.invoke({\"content\": \"What's the weather in SF today divided by 2.7\"})\n\n    {'content': \"What's the weather in SF today divided by 2.7\",\n     'output': \"The search results indicate that the weather in San Francisco is 67 ¬∞F. Now I will divide this temperature by 2.7 and provide you with the result. Please note that this is a mathematical operation and does not represent a meaningful physical quantity.\\n\\nLet's calculate 67 ¬∞F divided by 2.7.\\nThe result of dividing the current temperature in San Francisco, which is 67 ¬∞F, by 2.7 is approximately 24.815.\",\n     'thread_id': 'thread_hcpYI0tfpB9mHa9d95W7nK2B',\n     'run_id': 'run_qOuVmPXS9xlV3XNPcfP8P9W2'}\n\nLANGSMITH TRACE\nCustom execution‚Äã\n\nOr with LCEL we can easily write our own execution loop for running the assistant. This gives us full control over execution.\n\nagent = OpenAIAssistantRunnable.create_assistant(\n    name=\"langchain assistant e2b tool\",\n    instructions=\"You are a personal math tutor. Write and run code to answer math questions.\",\n    tools=tools,\n    model=\"gpt-4-1106-preview\",\n    as_agent=True,\n)\n\nfrom langchain.schema.agent import AgentFinish\n\n\ndef execute_agent(agent, tools, input):\n    tool_map = {tool.name: tool for tool in tools}\n    response = agent.invoke(input)\n    while not isinstance(response, AgentFinish):\n        tool_outputs = []\n        for action in response:\n            tool_output = tool_map[action.tool].invoke(action.tool_input)\n            print(action.tool, action.tool_input, tool_output, end=\"\\n\\n\")\n            tool_outputs.append(\n                {\"output\": tool_output, \"tool_call_id\": action.tool_call_id}\n            )\n        response = agent.invoke(\n            {\n                \"tool_outputs\": tool_outputs,\n                \"run_id\": action.run_id,\n                \"thread_id\": action.thread_id,\n            }\n        )\n\n    return response\n\nresponse = execute_agent(agent, tools, {\"content\": \"What's 10 - 4 raised to the 2.7\"})\nprint(response.return_values[\"output\"])\n\n    e2b_data_analysis {'python_code': 'result = 10 - 4 ** 2.7\\nprint(result)'} {\"stdout\": \"-32.22425314473263\", \"stderr\": \"\", \"artifacts\": []}\n    \n    \\( 10 - 4^{2.7} \\) equals approximately -32.224.\n\nUsing existing Thread‚Äã\n\nTo use an existing thread we just need to pass the \"thread_id\" in when invoking the agent.\n\nnext_response = execute_agent(\n    agent,\n    tools,\n    {\"content\": \"now add 17.241\", \"thread_id\": response.return_values[\"thread_id\"]},\n)\nprint(next_response.return_values[\"output\"])\n\n    e2b_data_analysis {'python_code': 'result = 10 - 4 ** 2.7 + 17.241\\nprint(result)'} {\"stdout\": \"-14.983253144732629\", \"stderr\": \"\", \"artifacts\": []}\n    \n    \\( 10 - 4^{2.7} + 17.241 \\) equals approximately -14.983.\n\nUsing existing Assistant‚Äã\n\nTo use an existing Assistant we can initialize the OpenAIAssistantRunnable directly with an assistant_id.\n\nagent = OpenAIAssistantRunnable(assistant_id=\"<ASSISTANT_ID>\", as_agent=True)\n\nPrevious\nConversational\nNext\nOpenAI functions"
}